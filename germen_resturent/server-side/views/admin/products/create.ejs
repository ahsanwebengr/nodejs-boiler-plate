<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head.ejs'); %>
</head>

<body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">
        <%- include('../partials/sidebar.ejs'); %>
            <!-- Content Wrapper -->
            <div id="content-wrapper" class="d-flex flex-column">
                <!-- Main Content -->
                <div id="content">
                    <%- include('../partials/topbar.ejs'); %>
                        <main class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card bg-white p-3 rounded shadow">
                                        <h2 class="fw-bold mb-4">Create Product</h2>
                                        <form id="createProductFrom" enctype="multipart/form-data">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="productName">Product Name</label>
                                                        <input type="text" id="productName"  class="form-control">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="price">Price €</label>
                                                        <input type="number" id="price" class="form-control">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="discount">Discount €</label>
                                                        <input type="number" id="discount" class="form-control">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="formFile" class="form-label">Image</label>
                                                        <input class="form-control" type="file" id="formFile">
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="description">Description</label>
                                                        <textarea name="" id="description" cols="30" rows="10" class="form-control"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <input type="submit" value="Create Product" class="btn btn-primary">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </main>
                </div>
                <%- include('../partials/footer.ejs'); %>
            </div>
    </div>
    <%- include('../partials/scripts.ejs'); %>

    <script>
        const createProductFrom = document.querySelector('#createProductFrom');

        createProductFrom.addEventListener('submit', async (e) => {
            e.preventDefault();

            const name = createProductFrom.querySelector('#productName').value;
            const unitPrice = createProductFrom.querySelector('#price').value;
            const discount = createProductFrom.querySelector('#discount').value;
            const img = createProductFrom.querySelector('#formFile').files[0];
            const description = createProductFrom.querySelector('#description').value;

            // Convert file to base64
            // const imageUrl = await readFileAsBase64(fileInput.files[0]);

            const formData = {
                name,
                unitPrice,
                description,
                img,
                discount
            };

            try {
                console.log(formData);
                const response = await fetch('http://localhost:8080/api/admin/addProduct', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();
                console.log(data, "=> DATA");
            } catch (error) {
                console.log(error);
            }
        });

        // Function to convert file to base64
        // function readFileAsBase64(file) {
        //     return new Promise((resolve, reject) => {
        //         const reader = new FileReader();
        //         reader.onload = () => resolve(reader.result);
        //         reader.onerror = error => reject(error);
        //         reader.readAsDataURL(file);
        //     });
        // }
    </script>


</body>
</html>
